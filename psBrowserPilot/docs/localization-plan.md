# ローカル実行調査と再設計

## 原因分析
- 既存の `psBrowserPilot/index.html` は NodeFlow ディレクトリ内のモジュールを `../NodeFlow/...` の形で参照しており、HTTP サーバー経由で配信される前提になっていた。
- ブラウザでローカルファイル (`file://` スキーム) を直接開いた場合、親ディレクトリにある ES Modules へのアクセスはセキュリティ上の制約でブロックされ、モジュール初期化が失敗するためイベントハンドラが動作しなかった。

## 解決策の調査結果
- NodeFlow のコア・ストレージ・エクスポート関連モジュールをアプリケーション配下にコピーし、同一オリジンから読み込むようにすればブラウザはモジュールを解決できる。
- コピーしたモジュールはすべて相対パス (`./psTemplate.js` など) で互いを参照しているため、ディレクトリ構造さえ維持すれば追加のビルド工程は不要である。

## 修正ロードマップ
1. NodeFlow から必要な `core/`, `export/`, `storage/`, `ui/` のファイルを `psBrowserPilot/nodeflow/` 配下に複製する。
2. `psBrowserPilot/index.html` で参照しているスタイルシートとモジュールのパスを `./nodeflow/...` に更新し、ローカル配下から読み込む。
3. ローカルコピーされたモジュール群が引き続き相互参照できることを確認し、UI 操作 (カスタムノードの開閉等) がブラウザ上で動作するか検証する。

## 再設計の概要
- `psBrowserPilot` 配下に `nodeflow/` ディレクトリを追加し、NodeFlow のランタイム資産を同梱する構成へ変更。
- エントリーポイント (`index.html`) からは同梱ディレクトリを参照するのみで、追加のビルドツール不要なローカルアプリ構成とした。
